# Comparing `tmp/swarmtube-0.1.41-py2.py3-none-any.whl.zip` & `tmp/swarmtube-0.1.43-py2.py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,9 +1,9 @@
-Zip file size: 46989 bytes, number of entries: 46
--rw-rw-r--  2.0 unx     1684 b- defN 24-May-15 12:20 swarmtube/__init__.py
+Zip file size: 50642 bytes, number of entries: 48
+-rw-rw-r--  2.0 unx     1684 b- defN 24-May-19 11:22 swarmtube/__init__.py
 -rw-rw-r--  2.0 unx      665 b- defN 24-May-04 08:01 swarmtube/definitions.py
 -rw-rw-r--  2.0 unx     6691 b- defN 24-May-02 16:20 swarmtube/swarmtube.py
 -rw-rw-r--  2.0 unx     1780 b- defN 24-May-02 16:20 swarmtube/cli/__init__.py
 -rw-rw-r--  2.0 unx     3834 b- defN 24-May-02 16:20 swarmtube/cli/config.py
 -rw-rw-r--  2.0 unx     2279 b- defN 24-May-02 16:20 swarmtube/cli/inventory.py
 -rw-rw-r--  2.0 unx     1577 b- defN 24-May-02 16:20 swarmtube/cli/main.py
 -rw-rw-r--  2.0 unx     1800 b- defN 24-May-02 16:20 swarmtube/cli/publish.py
@@ -19,30 +19,32 @@
 -rw-rw-r--  2.0 unx     7449 b- defN 24-May-02 16:20 swarmtube/helpers/general.py
 -rw-rw-r--  2.0 unx     4264 b- defN 24-May-02 16:20 swarmtube/helpers/loaders.py
 -rw-rw-r--  2.0 unx      725 b- defN 24-May-02 16:20 swarmtube/helpers/models.py
 -rw-rw-r--  2.0 unx     3388 b- defN 24-May-02 16:20 swarmtube/helpers/surreal.py
 -rw-rw-r--  2.0 unx      134 b- defN 24-May-02 16:20 swarmtube/logic/__init__.py
 -rw-rw-r--  2.0 unx     4448 b- defN 24-May-02 16:20 swarmtube/logic/crawler.py
 -rw-rw-r--  2.0 unx      611 b- defN 24-May-02 16:20 swarmtube/logic/inventory.py
--rw-rw-r--  2.0 unx    19499 b- defN 24-May-11 05:15 swarmtube/logic/swarmtube.py
+-rw-rw-r--  2.0 unx    20534 b- defN 24-May-19 09:26 swarmtube/logic/swarmtube.py
 -rw-rw-r--  2.0 unx       24 b- defN 24-May-02 16:20 swarmtube/mappers/__init__.py
 -rw-rw-r--  2.0 unx     1025 b- defN 24-May-02 16:20 swarmtube/mappers/inventory.py
 -rw-rw-r--  2.0 unx       24 b- defN 24-May-02 16:20 swarmtube/models/__init__.py
 -rw-rw-r--  2.0 unx     3568 b- defN 24-May-02 16:20 swarmtube/models/base.py
 -rw-rw-r--  2.0 unx     1887 b- defN 24-May-02 16:20 swarmtube/models/config.py
 -rw-rw-r--  2.0 unx       34 b- defN 24-May-02 16:20 swarmtube/models/enums.py
 -rw-rw-r--  2.0 unx     1886 b- defN 24-May-02 16:20 swarmtube/models/inventory.py
 -rw-rw-r--  2.0 unx     1675 b- defN 24-May-02 16:20 swarmtube/models/script.py
 -rw-rw-r--  2.0 unx     1907 b- defN 24-May-02 16:20 swarmtube/models/swarmtube.py
 -rw-rw-r--  2.0 unx     1649 b- defN 24-May-02 16:20 swarmtube/models/task.py
+-rw-rw-r--  2.0 unx        0 b- defN 24-May-19 06:38 swarmtube/particles/__init__.py
+-rw-rw-r--  2.0 unx    10268 b- defN 24-May-19 09:17 swarmtube/particles/fiware.py
 -rw-rw-r--  2.0 unx      555 b- defN 24-May-02 16:20 swarmtube/ports/__init__.py
 -rw-rw-r--  2.0 unx     1389 b- defN 24-May-02 16:20 swarmtube/ports/preferences.py
 -rw-rw-r--  2.0 unx      182 b- defN 24-May-02 16:20 swarmtube/storage/__init__.py
 -rw-rw-r--  2.0 unx     1330 b- defN 24-May-02 16:20 swarmtube/storage/surreal.py
--rw-rw-r--  2.0 unx      168 b- defN 24-May-15 12:23 swarmtube-0.1.41.dist-info/AUTHORS.rst
--rw-rw-r--  2.0 unx     1075 b- defN 24-May-15 12:23 swarmtube-0.1.41.dist-info/LICENSE
--rw-rw-r--  2.0 unx     2201 b- defN 24-May-15 12:23 swarmtube-0.1.41.dist-info/METADATA
--rw-rw-r--  2.0 unx      110 b- defN 24-May-15 12:23 swarmtube-0.1.41.dist-info/WHEEL
--rw-rw-r--  2.0 unx       49 b- defN 24-May-15 12:23 swarmtube-0.1.41.dist-info/entry_points.txt
--rw-rw-r--  2.0 unx       10 b- defN 24-May-15 12:23 swarmtube-0.1.41.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     3814 b- defN 24-May-15 12:23 swarmtube-0.1.41.dist-info/RECORD
-46 files, 126084 bytes uncompressed, 40943 bytes compressed:  67.5%
+-rw-rw-r--  2.0 unx      168 b- defN 24-May-19 11:23 swarmtube-0.1.43.dist-info/AUTHORS.rst
+-rw-rw-r--  2.0 unx     1075 b- defN 24-May-19 11:23 swarmtube-0.1.43.dist-info/LICENSE
+-rw-rw-r--  2.0 unx     2201 b- defN 24-May-19 11:23 swarmtube-0.1.43.dist-info/METADATA
+-rw-rw-r--  2.0 unx      110 b- defN 24-May-19 11:23 swarmtube-0.1.43.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       49 b- defN 24-May-19 11:23 swarmtube-0.1.43.dist-info/entry_points.txt
+-rw-rw-r--  2.0 unx       10 b- defN 24-May-19 11:23 swarmtube-0.1.43.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     3986 b- defN 24-May-19 11:23 swarmtube-0.1.43.dist-info/RECORD
+48 files, 137559 bytes uncompressed, 44324 bytes compressed:  67.8%
```

## zipnote {}

```diff
@@ -99,41 +99,47 @@
 
 Filename: swarmtube/models/swarmtube.py
 Comment: 
 
 Filename: swarmtube/models/task.py
 Comment: 
 
+Filename: swarmtube/particles/__init__.py
+Comment: 
+
+Filename: swarmtube/particles/fiware.py
+Comment: 
+
 Filename: swarmtube/ports/__init__.py
 Comment: 
 
 Filename: swarmtube/ports/preferences.py
 Comment: 
 
 Filename: swarmtube/storage/__init__.py
 Comment: 
 
 Filename: swarmtube/storage/surreal.py
 Comment: 
 
-Filename: swarmtube-0.1.41.dist-info/AUTHORS.rst
+Filename: swarmtube-0.1.43.dist-info/AUTHORS.rst
 Comment: 
 
-Filename: swarmtube-0.1.41.dist-info/LICENSE
+Filename: swarmtube-0.1.43.dist-info/LICENSE
 Comment: 
 
-Filename: swarmtube-0.1.41.dist-info/METADATA
+Filename: swarmtube-0.1.43.dist-info/METADATA
 Comment: 
 
-Filename: swarmtube-0.1.41.dist-info/WHEEL
+Filename: swarmtube-0.1.43.dist-info/WHEEL
 Comment: 
 
-Filename: swarmtube-0.1.41.dist-info/entry_points.txt
+Filename: swarmtube-0.1.43.dist-info/entry_points.txt
 Comment: 
 
-Filename: swarmtube-0.1.41.dist-info/top_level.txt
+Filename: swarmtube-0.1.43.dist-info/top_level.txt
 Comment: 
 
-Filename: swarmtube-0.1.41.dist-info/RECORD
+Filename: swarmtube-0.1.43.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## swarmtube/__init__.py

```diff
@@ -29,8 +29,8 @@
 11. [ ] define test cases (tests/*.py) and get main
 12. [ ] implement automatic test cases
 
 """
 
 __author__ = """Asterio Gonzalez"""
 __email__ = "asterio.gonzalez@gmail.com"
-__version__ = "0.1.41"
+__version__ = "0.1.43"
```

## swarmtube/logic/swarmtube.py

```diff
@@ -76,15 +76,21 @@
         inventory = self.subscriptions.setdefault(uid, [])
         if callback in inventory:
             inventory.remove(callback)
 
 
 class iAgent(object):
     def __init__(
-        self, uid, broker: Broker, storage: WaveStorage, meta=None, *args, **kw
+        self,
+        uid,
+        broker: Broker,
+        storage: WaveStorage,
+        meta=None,
+        *args,
+        **kw,
     ):
         self.uid = uid
         self.broker = broker
         self.storage = storage
 
         self.state = ST_INIT
         self.meta = {} if meta is None else meta
@@ -113,15 +119,20 @@
     """Represents the concept of a stream of events that
     can be located by a UID or searching metadata
     """
 
     uid: UID
 
     def __init__(
-        self, uid: UID, sources: List[UID], broker: Broker, storage: Storage, meta=None
+        self,
+        uid: UID,
+        sources: List[UID],
+        broker: Broker,
+        storage: Storage,
+        meta=None,
     ):
         super().__init__(uid=uid, broker=broker, storage=storage, meta=meta)
         self.sources = sources
 
 
 class App(iAgent):
     "TBD"
@@ -249,16 +260,20 @@
     "TBD"
     MAX_EVENTS = 1024
     _live = Dict[UID, List[Event]] | None
     _historical = Dict[UID, List[Event]] | None
 
     RETRY_DELAY = 15
 
-    def __init__(self, uid: UID, sources: List[UID], broker: Broker, storage: Storage):
-        super().__init__(uid, sources=sources, broker=broker, storage=storage)
+    def __init__(
+        self, uid: UID, sources: List[UID], broker: Broker, storage: Storage
+    ):
+        super().__init__(
+            uid, sources=sources, broker=broker, storage=storage
+        )
         # self.uid = uid
         # self.sources = sources
         # self.broker = broker
         # self.storage = storage
         self._wave = {}
         self._live = {}
         self._historical = {}
@@ -281,29 +296,33 @@
 
         log.info("=" * 70)
         log.info("[%s] >> Idle", self.uid)
         log.info("=" * 70)
 
         while self.state < ST_STOPPED:
             try:
-                event = await asyncio.wait_for(self._live_activity.get(), timeout=2.0)
+                event = await asyncio.wait_for(
+                    self._live_activity.get(), timeout=2.0
+                )
                 _uid, _wave, edge = self.pop_edge(self._live)
                 if edge:
                     await self.dispatch(edge)
                     # self._wave[_uid] = _wave
                 else:
                     assert not all(
                         self._live.values()
                     ), "some input must be missing here!"
                     break
             except asyncio.TimeoutError:
                 pass  #  No live data has been received
             except Exception as why:
                 log.error(why)
-                log.error("".join(traceback.format_exception(*sys.exc_info())))
+                log.error(
+                    "".join(traceback.format_exception(*sys.exc_info()))
+                )
 
             # self._live_activity.clear()
 
             self.metrics.update(n=0)
 
         await self._stop_live()
 
@@ -364,15 +383,17 @@
                                 # so is already processed
                                 # print(f"*** already processed: --> {candidate}")
                                 pass
                         except IndexError:
                             break
                 if n == 0:
                     log.info("*" * 70)
-                    log.info("[%s] ** Switching to LIVE STREAMING **", self.uid)
+                    log.info(
+                        "[%s] ** Switching to LIVE STREAMING **", self.uid
+                    )
                     log.info("*" * 70)
                     self.metrics.update(n=0, force=True)
                     self.state = ST_LIVE
 
             # try to process buffer
             while self.state < ST_LIVE:
                 _uid, _wave, edge = self.pop_edge(buffer)
@@ -383,15 +404,16 @@
                 elif self.state == ST_SWITCHING:
                     break
                 else:
                     break  # continue loading more historical
             # check if we have an overflow while processing historical data
             if self._need_resync:
                 log.info(
-                    "[%s] *** ---> Request Stopping Streaming due OVERFLOW", self.uid
+                    "[%s] *** ---> Request Stopping Streaming due OVERFLOW",
+                    self.uid,
                 )
                 await self._stop_live()
 
     def live(self, uid: UID, event: Dict):
         "TBD"
         if len(self._live[uid]) >= self.MAX_EVENTS:
             self._need_resync = True
@@ -486,31 +508,51 @@
                         wave,
                     )
                 else:
                     log.error("data %s has no %s key", data, MONOTONIC_KEY)
                 break  #  let continue with next wave
             except SkipWave as why:
                 # some error is produced, but we want to jump to the next wave
-                log.info("Skip wave, reason: %s", why)
+                wave = data.get(MONOTONIC_KEY)  # Must exist!
+                if wave:
+                    log.info("Skip wave [%s], reason: %s", wave, why)
+
+                    await self.storage.update_sync_wave(
+                        self.sources,
+                        self.uid,
+                        wave,
+                    )
+                else:
+                    log.error("data %s has no %s key!", data, MONOTONIC_KEY)
                 break  #  let continue with next wave
             except RetryWave as why:
                 delay = self.RETRY_DELAY
                 for msg in why.args:
                     log.info("Retry wave, reason: %s", msg)
                     if isinstance(msg, dict):
                         delay = msg.get("delay", self.RETRY_DELAY)
                 log.warning(
-                    "%s._compute() has failed but is needed a retry (%s seg)",
+                    "%s._compute() has failed but is needed a retry (%s secs)",
                     str(self),
                     delay,
                 )
                 await asyncio.sleep(delay)
             except Exception as why:
                 log.error(why)
-                log.error("".join(traceback.format_exception(*sys.exc_info())))
+                log.error(
+                    "".join(traceback.format_exception(*sys.exc_info()))
+                )
+                delay = self.RETRY_DELAY * 10
+                log.warning(
+                    "%s._compute() has failed for an UNEXPECTED reason. "
+                    "Wave edge can't be moved forward, retry in (%s secs)",
+                    str(self),
+                    delay,
+                )
+                await asyncio.sleep(delay)
 
     async def _compute(self, edge, ekeys):
         """
         Return None if we don't want to store info
         """
         raise NotImplementedError()
```

## Comparing `swarmtube-0.1.41.dist-info/LICENSE` & `swarmtube-0.1.43.dist-info/LICENSE`

 * *Files identical despite different names*

## Comparing `swarmtube-0.1.41.dist-info/METADATA` & `swarmtube-0.1.43.dist-info/METADATA`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: swarmtube
-Version: 0.1.41
+Version: 0.1.43
 Summary: Swarm Workflow based on Tubes
 Home-page: https://github.com/asterio.gonzalez/swarmtube
 Author: Asterio Gonzalez
 Author-email: asterio.gonzalez@gmail.com
 License: MIT license
 Keywords: swarmtube
 Classifier: Development Status :: 2 - Pre-Alpha
```

## Comparing `swarmtube-0.1.41.dist-info/RECORD` & `swarmtube-0.1.43.dist-info/RECORD`

 * *Files 5% similar despite different names*

```diff
@@ -1,8 +1,8 @@
-swarmtube/__init__.py,sha256=bFZdkwjmzMYz9-vg1BfdTIyHlGywoARLWqOvFi04iT4,1684
+swarmtube/__init__.py,sha256=LChfVT0tgXLZR7RMg6AMz_GxYhXjfot0QJDY61lBcdE,1684
 swarmtube/definitions.py,sha256=aU08kgwbLPmUwZKdMYAAWNSNl5ZBIk70pkkx0VjKzlI,665
 swarmtube/swarmtube.py,sha256=uktSYYLbcB6wLd3SH6n_7MsZULi4xXl3tljJ1sCj7Js,6691
 swarmtube/cli/__init__.py,sha256=vn0EccAVZb4LjRugK__sLjr4OHBrPV8tK-ScyYSoQpc,1780
 swarmtube/cli/config.py,sha256=3oW1q326XFGlLABSZLqT-NSu3j27rhkAyXqcypBUO7Q,3834
 swarmtube/cli/inventory.py,sha256=Vnjc4uKeOspYyX5-GOvFx04F96lbzLTtla0ba33j2zY,2279
 swarmtube/cli/main.py,sha256=D7OxrEy-fy7N85CwdWOH81We37MTk2PgBrtuU_ClR28,1577
 swarmtube/cli/publish.py,sha256=JhZWxYagMQrIRgFtlaTE9XJ8saXFkhMqnFIPFAeIxwo,1800
@@ -18,29 +18,31 @@
 swarmtube/helpers/general.py,sha256=9JodQzN-muq9x1fcIUAblsAjM8jG8faGAeKmwgpF3xI,7449
 swarmtube/helpers/loaders.py,sha256=g_aBdqFWnOVh5CzPA_cluI9hKbav-5u8prkUXTJ-4zQ,4264
 swarmtube/helpers/models.py,sha256=p6BexQJtL5hui1OiOrddgvdyyl4i3t_ngiO1tXvjGMA,725
 swarmtube/helpers/surreal.py,sha256=x7OuU4igSD9IteRahY7-GMjIxic0stpFJNgijd8rZK4,3388
 swarmtube/logic/__init__.py,sha256=kUGgcg-toK_leB9i-HhPZ7BPClBI7yecUaVPhnJ0pzI,134
 swarmtube/logic/crawler.py,sha256=vFvaWpED_vlU_ViFQIG2A9IiaK8b_HafHiwJeq5H_og,4448
 swarmtube/logic/inventory.py,sha256=qRgbQGjEO6vv2MWTSl8h3y6VBR2IxuY4bhIw1GQ2Hzg,611
-swarmtube/logic/swarmtube.py,sha256=fZ3lk6vH1Qpt9eM8opnSgDTigSufU67q4FqeTgBzAjI,19499
+swarmtube/logic/swarmtube.py,sha256=AOONGUoaB3nYUurxYKmNyICGYiLCcwagboQfpdV8-xw,20534
 swarmtube/mappers/__init__.py,sha256=R6ShzAMfqiKh_FSrZK7T-giu44Ioo3ePkZpsoGPdo-Y,24
 swarmtube/mappers/inventory.py,sha256=LVlPPbrUZwwBdQP4OWk1occWl8-7ccGFGe8OnCrQ1WM,1025
 swarmtube/models/__init__.py,sha256=1H3-lETubfvf57NaX29AUdoJ1JG_r9yxHSGbljiEtaM,24
 swarmtube/models/base.py,sha256=F49yBmd1J4oSzLKU1EFFm7XdFi_rjs03B99dOcu_Eeg,3568
 swarmtube/models/config.py,sha256=cMhlQzCgo0N9qBMRQEPbBj1UxAC_OZc_PNLeNSoGV2M,1887
 swarmtube/models/enums.py,sha256=QxW9YtWOVokO3gXjELfE52paN_ZUNnXhs1HBtTpvZFE,34
 swarmtube/models/inventory.py,sha256=-18lewwVXVrRlq7CfALqKiNjVdwSoKCdRX-KtN2_uD0,1886
 swarmtube/models/script.py,sha256=pwCxOht-OXeysa8c0D9M6OyUdSDe7UaHiCVxSdOVU0M,1675
 swarmtube/models/swarmtube.py,sha256=dACX0MkqchNveuuoxGyYzKvIL6zTKKBYeSmxp_41OKc,1907
 swarmtube/models/task.py,sha256=ygyl1Fd8MI_x8S4KSFo50o3_YaE5n7F9kx4390T-ItU,1649
+swarmtube/particles/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
+swarmtube/particles/fiware.py,sha256=WpUeqnpVytO_t7EgApilHvfCRRF-RCrMzmJU302ze00,10268
 swarmtube/ports/__init__.py,sha256=DUg8Upo_F0Y8LxfTqh1Q8IYSChmGSp1ZlZqwI-NXdag,555
 swarmtube/ports/preferences.py,sha256=RrSG1IrHu0_eiFVr9-LhFckPHDj7RcEVQTTDhJKO_uk,1389
 swarmtube/storage/__init__.py,sha256=CSNhFbyDpDg_fxHHw9x2GcOdx8qXZTw50_cKxKgtJ4g,182
 swarmtube/storage/surreal.py,sha256=QTEikrYghbv8nyKjc02aJRBcvBlppCNKmxjI4Qned-8,1330
-swarmtube-0.1.41.dist-info/AUTHORS.rst,sha256=3ZPoqg8Aav8DSYKd0fwcwn4_5HwSiMLart0E5Un00-U,168
-swarmtube-0.1.41.dist-info/LICENSE,sha256=JqzQ9S4hVjQBOM8SiUG9-qhokt1oKfE2qJMRNa3t410,1075
-swarmtube-0.1.41.dist-info/METADATA,sha256=HYZFJRUKa_brhkkndisoxsPxEhP2nQAtkkfov4BLt8c,2201
-swarmtube-0.1.41.dist-info/WHEEL,sha256=DZajD4pwLWue70CAfc7YaxT1wLUciNBvN_TTcvXpltE,110
-swarmtube-0.1.41.dist-info/entry_points.txt,sha256=X-CwHgWDulWyiPxEbHmHwg9mE7FxpaCOHctheYiJgeM,49
-swarmtube-0.1.41.dist-info/top_level.txt,sha256=jJMGZgOJVEYy1TfxYBXsNV5EzL59YaT1xSDO5Fe4Pr8,10
-swarmtube-0.1.41.dist-info/RECORD,,
+swarmtube-0.1.43.dist-info/AUTHORS.rst,sha256=3ZPoqg8Aav8DSYKd0fwcwn4_5HwSiMLart0E5Un00-U,168
+swarmtube-0.1.43.dist-info/LICENSE,sha256=JqzQ9S4hVjQBOM8SiUG9-qhokt1oKfE2qJMRNa3t410,1075
+swarmtube-0.1.43.dist-info/METADATA,sha256=XDJ_9Ss00OalM_XNyo2Gld7RgRPVYZ_oBP5GwKc-VYM,2201
+swarmtube-0.1.43.dist-info/WHEEL,sha256=DZajD4pwLWue70CAfc7YaxT1wLUciNBvN_TTcvXpltE,110
+swarmtube-0.1.43.dist-info/entry_points.txt,sha256=X-CwHgWDulWyiPxEbHmHwg9mE7FxpaCOHctheYiJgeM,49
+swarmtube-0.1.43.dist-info/top_level.txt,sha256=jJMGZgOJVEYy1TfxYBXsNV5EzL59YaT1xSDO5Fe4Pr8,10
+swarmtube-0.1.43.dist-info/RECORD,,
```

